<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.27.1" />
  <meta name="author" content="Alexander Wagner">
  <meta name="description" content="Data Enthusiast">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="suspiciously datalicious">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="suspiciously datalicious">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="/post/2017-09-22-install-spark-on-windows/">

  

  <title>Install ApacheSpark on Windows | suspiciously datalicious</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">suspiciously datalicious</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  

  <div class="article-container">
    <h1 itemprop="name">Install ApacheSpark on Windows</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-09-22 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Fri, Sep 22, 2017
    </time>
  </span>

  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/infrastructure">Infrastructure</a
    >
    
  </span>
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/spark">Spark</a
    >, 
    
    <a href="/tags/hadoop">Hadoop</a
    >, 
    
    <a href="/tags/windows">Windows</a
    >, 
    
    <a href="/tags/bash-on-windows">Bash on Windows</a
    >, 
    
    <a href="/tags/pyspark">PySpark</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2f2017-09-22-install-spark-on-windows%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Install%20ApacheSpark%20on%20Windows&amp;url=%2fpost%2f2017-09-22-install-spark-on-windows%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2f2017-09-22-install-spark-on-windows%2f&amp;title=Install%20ApacheSpark%20on%20Windows"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2f2017-09-22-install-spark-on-windows%2f&amp;title=Install%20ApacheSpark%20on%20Windows"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Install%20ApacheSpark%20on%20Windows&amp;body=%2fpost%2f2017-09-22-install-spark-on-windows%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      

<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#system-requirements">System requirements</a>

<ul>
<li><a href="#a-general-note-of caution-for-bash-on-windows">A general note of caution for Bash on Windows</a></li>
<li><a href="#install-java">Install Java</a></li>
<li><a href="#install-python">Install Python</a></li>
<li><a href="#example-output-for-system">Example output for system</a></li>
</ul></li>
<li><a href="#install-scala">Install Scala</a></li>
<li><a href="#setting-environment-variables">Setting environment variables</a></li>
<li><a href="#download/clone-windows-utilities-for-corresponding-hadoop-version">Download/clone windows utilities for corresponding Hadoop version</a></li>
<li><a href="#make-/tmp/hive-writable">Make /tmp/hive writable</a></li>
<li><a href="#run-spark-shell">Run Spark shell</a></li>
<li><a href="#run-pyspark">Run PySpark</a></li>
</ul>

<h2 id="overview">Overview</h2>

<p>This is a quick tutorial how to install ApacheSpark on Windows via the pre-built on Apache Hadoop. It is assumed that the reader has basic knowledge of the Windows command line (CMD) and, if Bash should be used, a basic familiarity with Bash on Ubuntu on Windows (part of Linux Subsystem on Windows). We will demonstrate a basic example how to use Scala and Python (via PySpark) from the command line.</p>

<h2 id="system-requirements">System requirements</h2>

<p>We show how to install Spark on Windows 10 (see exact system info below) but generally it should also work on Windows 7. You will require (we give install instructions below)</p>

<ul>
<li>Windows 10 (prior versions, i.e. Windows &gt;= 7, may work but not tested)</li>
<li>Bash on Ubuntu on Windows (Linux subsystem on Windows) in case Bash should be used (not required per se)</li>
<li>Java runtime environment (JRE) or Java Development Kit (JDK) version &gt;= 8</li>
<li>Scala</li>
<li>Python (in case you want to use PySpark)</li>
</ul>

<h3 id="a-general-note-of-caution-for-bash-on-windows">A general note of caution for Bash on Windows</h3>

<p>If you plan to set up Bash on Windows to work with Spark etc. you will eventually edit configuration files of the Linux on Windows subsystem. It is <strong>very important</strong> that you do not use any Windows apps/tools to perform any operation on Linux files as these files may get corrupted. This includes using any Windows editor to edit Linux files (e.g. Notepad/++). For more details, see <a href="https://blogs.msdn.microsoft.com/commandline/2016/11/17/do-not-change-linux-files-using-windows-apps-and-tools/" target="_blank">Do not change Linux files using Windows apps and tools</a>.</p>

<h3 id="install-java">Install Java</h3>

<p>Binary installers for Java can be downloaded from <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank">Oracle Java SE</a>. To run Spark, you only require a Java runtime environment (JRE) but you may also download the Java development kit (JDK) which includes the JRE. Note that the path to the JRE may be different when using a JDK.</p>

<p>You can check which version of Java you are running on the CMD via</p>

<pre><code>java -version
</code></pre>

<p>In case you like to use Bash, you will need to install Java on the Linux subsystem for Windows separately as it is a distinct OS. You can do so by following instructions from @rs6g10 on <a href="https://github.com/Microsoft/BashOnWindows/issues/49" target="_blank">Microsoft/BashOnWindows/Unable to install Java JDK or Runtime #49</a>.</p>

<h3 id="install-python">Install Python</h3>

<p>If you like to use the Spark Python API via PySpark, you will need to install Python. A frequently recommended distribution is often that of <a href="https://www.anaconda.com/download/" target="_blank">Anaconda</a> as it ships with a lot of useful libraries and has binary installers for Windows. Note that Bash on Windows already comes with Python 2.7 pre-installed so in case you like to work with Python3, you will have to install it using standard Bash workflow.</p>

<h3 id="example-output-for-system">Example output for system</h3>

<p>We show how our system is set up (your&rsquo;s will probably vary). Type below commands in CMD (in succession)</p>

<pre><code>systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot;
java -version
python --version
</code></pre>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/cmd_system_and_version_info.PNG" alt="CMD System Info" /></p>

<p>We can do the same for Bash (note the default version of Python)</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/bash_system_and_version_info.PNG" alt="Bash System Info" /></p>

<h2 id="install-scala">Install Scala</h2>

<p>Generally, you can find Scala downloads <a href="https://scala-lang.org/download/" target="_blank">here</a>. Find the Windows installer (in our case clicking on scala-2.12.3.msi under section Archive) downloads <a href="https://downloads.lightbend.com/scala/2.12.3/scala-2.12.3.msi" target="_blank">this</a>. Follow installation wizard.</p>

<p>Once the installation is finished, open a new CMD and type</p>

<pre><code>scala
</code></pre>

<p>Your output should look like this</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/cmd_scala_check_after_install.PNG" alt="CMD Scala Check" /></p>

<h2 id="install-spark">Install Spark</h2>

<p>Find the latest stable version of Spark on <a href="http://spark.apache.org/downloads.html" target="_blank">Apache Spark Downloads</a> and use pre-built on Hadoop and direct download.</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/download_spark.PNG" alt="Spark Download Page" /></p>

<p>Copy/save the .tgz file to/at the location where you like Spark to reside and extract it from some Linux shell (e.g. Bash, Cygwin) via below command (your file name may vary). Alternatively, you can use some extraction software such as 7zip.</p>

<pre><code># in case tar program is not installed, install e.g. via sudo apt-get install tar
tar xzfv spark-2.2.0-bin-hadoop2.7.tgz
</code></pre>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/bash_extract_spark_tgz.PNG" alt="Bash extract Spark" /></p>

<p>After some time, your Spark install (extraction) should be done and a couple of folders being created at your chosen location.</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/spark_directory.png" alt="Spark Directory" /></p>

<h2 id="setting-environment-variables">Setting environment variables</h2>

<p>In order to make the system aware of all programs, we will be setting some environment variables. This can be done by simply using Windows search function in start menu and typing something like <code>environment variables</code> and clicking the program <code>Edit the system environment variables</code>. We will set the following variables (your location may vary)</p>

<ul>
<li>JAVA_HOME: C:\Program Files\Java\jre1.8.0_144</li>
<li>SPARK_HOME: D:\spark\spark-2.2.0-bin-hadoop2.7</li>
<li>HADOOP_HOME: D:\spark\spark-2.2.0-bin-hadoop2.7\bin</li>
</ul>

<p>Moreover, we will expand the system path with</p>

<ul>
<li>C:\Program Files\Java\jre1.8.0_144\bin</li>
<li>D:\spark\spark-2.2.0-bin-hadoop2.7\bin</li>
</ul>

<p>Note that the system environment variables are not necessarily shared with the Linux subsystem for Windows (although PATH seems to be shared). Any environment variable would thus have to be set in respective Linux configuration file.</p>

<p>Your Windows environment variables may look something like this now</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/windows_environment_variables.PNG" alt="Windows Environment Variables" /></p>

<h2 id="download-clone-windows-utilities-for-corresponding-hadoop-version">Download/clone windows utilities for corresponding Hadoop version</h2>

<p>Go to <a href="https://github.com/steveloughran/winutils" target="_blank">Github/steveloughran/winutils</a> and clone/copy the Windows utilities for your Hadoop version to your local Hadoop directory. Copy \winutils-master\winutils-master\hadoop-2.7.1\bin and paste into your Spark install. For us this would be D:\spark\spark-2.2.0-bin-hadoop2.7\bin.</p>

<h2 id="make-tmp-hive-writable">Make /tmp/hive writable</h2>

<p>To avoid a common error (see e.g. <a href="https://stackoverflow.com/questions/34196302/the-root-scratch-dir-tmp-hive-on-hdfs-should-be-writable-current-permissions" target="_blank">The root scratch dir: /tmp/hive on HDFS should be writable. Current permissions are: rw-rw-rw- (on Windows)</a> or  <a href="https://hernandezpaul.wordpress.com/2016/01/24/apache-spark-installation-on-windows-10/" target="_blank">Apache Spark installation on Windows 10</a> open CMD as administrator and run below against your Spark directory where Winutils should reside (so in our case in D:\spark\spark-2.2.0-bin-hadoop2.7\bin\bin)</p>

<pre><code>D:\&gt;spark\spark-2.2.0-bin-hadoop2.7\bin\bin\winutils.exe chmod 777 \tmp\hive
</code></pre>

<h2 id="run-spark-shell">Run Spark shell</h2>

<p>Finally, we can test our Spark installation by running the shell</p>

<pre><code>spark-shell
</code></pre>

<p>Your output should look something like below</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/cmd_spark-shell.PNG" alt="CMD Initial Spark Shell" /></p>

<p>We execute a minimal example from <a href="http://spark.apache.org/docs/latest/quick-start.html" target="_blank">Apache Spark Quick Start</a> (note that the README file is located one directory up) to test basic functionality.</p>

<pre><code class="language-scala">val textFile = spark.read.textFile(&quot;../README.md&quot;)
textFile.count() // Number of items in this Dataset
textFile.first() // First item in this Dataset
</code></pre>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/cmd_scala_initial_test.PNG" alt="CMD Scala Initial Test" /></p>

<p>Since the Linux subsystem for Windows inherits the Path variables from Windows, we can run the same without further adjustments on Bash on Ubuntu on Windows</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/bash_spark-shell.PNG" alt="Bash Spark Shell" /></p>

<h2 id="run-pyspark">Run PySpark</h2>

<p>Assuming you also want to use Python with Spark via <a href="http://spark.apache.org/docs/2.1.0/api/python/pyspark.html" target="_blank">PySpark</a> and have followed above setup instructions, you can open a new CMD and type below to test if PySpark works</p>

<pre><code>pyspark
# we show it with bin/pyspark but both will work if your environment variables are properly set
</code></pre>

<p>Again, we execute a minimal example from <a href="https://spark.apache.org/examples.html" target="_blank">Apache Spark Examples</a>.</p>

<pre><code class="language-python">text_file = sc.textFile(&quot;README.md&quot;)
counts = text_file.flatMap(lambda line: line.split(&quot; &quot;)) \
             .map(lambda word: (word, 1)) \
             .reduceByKey(lambda a, b: a + b)
print(counts)
</code></pre>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/cmd_pyspark_initial_test.PNG" alt="CMD PySpark Initial Test" /></p>

<p>As before, the same command works in Bash but note the default Python version used</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/bash_pyspark_initial_test.PNG" alt="Bash PySpark Initial Test" /></p>

<p>In case you want to work with a different Python version, adjust respective Bash configuration file to export the environment variable (see line below). In our case, we use Python3.4 and define it in the <code>.profile</code> file in the Bash home directory (<code>~</code>).</p>

<pre><code>export PYSPARK_PYTHON=python3.4
</code></pre>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/bash_nano_profile.PNG" alt="Bash nano profile" /></p>

<p>The PySpark shell now runs Python 3.4 as default (this obviously needs to be adjusted in case you like to run a different Python version).</p>

<p><img src="/post/img/2017-09-22-install-spark-on-windows/bash_pyspark_python3.PNG" alt="bash_pyspark_python3" /></p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="/post/2016-12-30-hello-markdown/"><span
      aria-hidden="true">&larr;</span> A Plain Markdown Post</a></li>
    

    
    <li class="next"><a href="/post/install-docker-on-windows/">Install Docker on Windows <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "triamus-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Alexander Wagner &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-104080060-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

